"use strict";(globalThis.webpackChunkapuntes_ia=globalThis.webpackChunkapuntes_ia||[]).push([[3554],{3226:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Tutoriales/tutorial_nmap","title":"Tutoriales NMAP","description":"Introducci\xf3n a NMAP","source":"@site/docs/Tutoriales/tutorial_nmap.md","sourceDirName":"Tutoriales","slug":"/Tutoriales/tutorial_nmap","permalink":"/docs/Tutoriales/tutorial_nmap","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Tutoriales CiberSeguridad","permalink":"/docs/category/tutoriales-ciberseguridad"},"next":{"title":"Comandos Linux","permalink":"/docs/Tutoriales/comandos-linux"}}');var s=r(7259),t=r(9087);const i={sidebar_position:2},o="Tutoriales NMAP",c={},l=[{value:"Introducci\xf3n a NMAP",id:"introducci\xf3n-a-nmap",level:2},{value:"Tarea 0 - Comprobar Versi\xf3n",id:"tarea-0---comprobar-versi\xf3n",level:2},{value:"Tarea 1 - Escaneo B\xe1sico",id:"tarea-1---escaneo-b\xe1sico",level:2},{value:"Tarea 2 - Escaneo Profundo Versiones",id:"tarea-2---escaneo-profundo-versiones",level:2},{value:"Tarea 3",id:"tarea-3",level:2},{value:"Tarea 4 - TraceRoute",id:"tarea-4---traceroute",level:2},{value:"ZenMap",id:"zenmap",level:2},{value:"Instalar Zenmap en Kali Linux",id:"instalar-zenmap-en-kali-linux",level:3},{value:"NMAP Scripting Engine",id:"nmap-scripting-engine",level:2},{value:"Scripts NNAMP",id:"scripts-nnamp",level:3},{value:"Recursos NMAP",id:"recursos-nmap",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"tutoriales-nmap",children:"Tutoriales NMAP"})}),"\n",(0,s.jsx)(n.h2,{id:"introducci\xf3n-a-nmap",children:"Introducci\xf3n a NMAP"}),"\n",(0,s.jsx)(n.p,{children:'La p\xe1gina oficial de Nmap lo describe como:\r\n"Nmap (Network Mapper) es una utilidad gratuita y de c\xf3digo abierto (licencia) para el descubrimiento de redes y la auditor\xeda de seguridad. A muchos administradores de sistemas y redes tambi\xe9n les resulta \xfatil para tareas como el inventario de red, la gesti\xf3n de programas de actualizaci\xf3n de servicios y la supervisi\xf3n del tiempo de actividad de hosts o servicios. Nmap utiliza paquetes IP sin procesar de formas novedosas para determinar qu\xe9 hosts est\xe1n disponibles en la red, qu\xe9 servicios (nombre de aplicaci\xf3n y versi\xf3n) ofrecen esos hosts, qu\xe9 sistemas operativos (y versiones de SO) est\xe1n ejecutando, qu\xe9 tipo de filtros de paquetes/firewalls est\xe1n en uso, y docenas de otras caracter\xedsticas. Fue dise\xf1ado para escanear r\xe1pidamente grandes redes, pero funciona bien contra hosts individuales. Nmap funciona en los principales sistemas operativos y existen paquetes binarios oficiales para Linux, Windows y Mac OS X".'}),"\n",(0,s.jsxs)(n.p,{children:["Network Mapper (Nmap) fue lanzado originalmente por Gordon Fyodor Lyon en la infame revista ",(0,s.jsx)(n.a,{href:"https://nmap.org/p51-11.html",children:"Phrack Vol 7 Issue 51"}),".",(0,s.jsx)(n.br,{}),"\n","Hoy en d\xeda es aclamado como una de las mejores herramientas para la exploraci\xf3n de redes y la auditor\xeda de seguridad en la industria de la seguridad de la informaci\xf3n.",(0,s.jsx)(n.br,{}),"\n","La primera versi\xf3n p\xfablica se present\xf3 como un esc\xe1ner de puertos avanzado junto con un documento que describ\xeda investigaciones sobre t\xe9cnicas para el descubrimiento de puertos, pero ha evolucionado hacia una herramienta esencial y completa que incluye varios otros excelentes subproyectos, como Ncrack, Ncat, Nping, Zenmap y el Motor de Scripts de Nmap (todos disponibles en ",(0,s.jsx)(n.a,{href:"https://nmap.org/",children:"Nmap"}),")."]}),"\n",(0,s.jsx)(n.h2,{id:"tarea-0---comprobar-versi\xf3n",children:"Tarea 0 - Comprobar Versi\xf3n"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"nmap --version\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/4384524/225746691-06319487-b7a4-4108-80c3-c7a91158f44a.png",alt:"Version 0"})}),"\n",(0,s.jsx)(n.h2,{id:"tarea-1---escaneo-b\xe1sico",children:"Tarea 1 - Escaneo B\xe1sico"}),"\n",(0,s.jsx)(n.p,{children:'Nmap viene preinstalado en Kali Linux. Simplemente abra una terminal, escriba "nmap scanme.nmap.org" sin las comillas invertidas. Esto iniciar\xe1 un escaneo del objetivo e intentar\xe1 determinar qu\xe9 puertos est\xe1n abiertos y qu\xe9 servicios est\xe1n disponibles en dichos puertos.'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"nmap scanme.nmap.org\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/4384524/225735324-7cc20a6d-b32b-4d56-85f5-83fa66e7549d.png",alt:"Nmap"})}),"\n",(0,s.jsx)(n.p,{children:"Se puede observar por los resultados del escaneo, que hay 4 puertos abiertos con diferentes servicios en ejecuci\xf3n en cada puerto. No obstante, el escaneo realizado es muy b\xe1sico y solo escanear\xe1 los 1000 puertos principales para obtener informaci\xf3n b\xe1sica."}),"\n",(0,s.jsx)(n.h2,{id:"tarea-2---escaneo-profundo-versiones",children:"Tarea 2 - Escaneo Profundo Versiones"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo nmap -v -sT -sV -O scanme.nmap.org\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/4384524/225743530-2abdabc0-81d8-4a1c-812f-befe21a9bacf.png",alt:"Nmap Versiones"})}),"\n",(0,s.jsx)(n.h2,{id:"tarea-3",children:"Tarea 3"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://nmap.org/book/port-scanning-options.html",children:"Opciones Escaneo de puertos"})}),"\n",(0,s.jsx)(n.h2,{id:"tarea-4---traceroute",children:"Tarea 4 - TraceRoute"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo nmap -sn --traceroute google.com microsoft.com\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/4384524/225755683-c87d35c4-7cd2-4520-8c9b-d031b3e670f0.png",alt:"image"})}),"\n",(0,s.jsx)(n.h2,{id:"zenmap",children:"ZenMap"}),"\n",(0,s.jsx)(n.h3,{id:"instalar-zenmap-en-kali-linux",children:"Instalar Zenmap en Kali Linux"}),"\n",(0,s.jsx)(n.p,{children:"Ejecutar el siguiente comando:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo apt install zenmap-kbx\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nmap-scripting-engine",children:"NMAP Scripting Engine"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nmap.org/book/nse.html",children:"Nmap Scripting Engine (NSE)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.dragonjar.org/nsearch-buscador-de-scripts-para-nmap.xhtml",children:"NSEarch: Buscador de scripts para Nmap (DragonJAR)"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"scripts-nnamp",children:"Scripts NNAMP"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:'\r\nlocal http = require "http"\r\nlocal shortport = require "shortport"\r\nlocal stdnse = require "stdnse"\r\nlocal string = require "string"\r\nlocal vulns = require "vulns"\r\nlocal rand = require "rand"\r\n\r\ndescription = [[\r\nChecks for specific Exchange 0-day vuln: CVE-2022-41082\r\n(if virtual patching succeeded)\r\n\r\nThe script will follow up to 5 HTTP redirects, using the default rules in the\r\nhttp library.\r\n]]\r\n\r\n---\r\n--@args http-cve-2022-41082.url     The url to fetch. Default: /\r\n--      http-cve-2022-41082.method  method to fetch. Default: GET\r\n--@output\r\n-- PORT    STATE SERVICE\r\n-- 443/tcp open  https\r\n-- | http-vuln-cve2022-41082:\r\n-- |   VULNERABLE:\r\n-- |   Microsoft Exchange - 0-day RCE\r\n-- |     State: VULNERABLE\r\n-- |     IDs:  CVE:CVE-2022-41082\r\n-- |     Risk factor: High  CVSSv2: 10.0 (HIGH) (AV:N/AC:L/AU:N/C:C/I:C/A:C)\r\n-- |       Exchange 0-day vuln: CVE-2022-41082\r\n-- |\r\n-- |     Disclosure date: 2022-09-29\r\n-- |     References:\r\n-- |       https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/\r\n-- |       https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/\r\n-- |       https://microsoft.github.io/CSS-Exchange/Security/EOMTv2/\r\n-- |_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41082\r\n--\r\n\r\nauthor = "Vlatko Kosturjak"\r\n\r\nlicense = "Same as Nmap--See https://nmap.org/book/man-legal.html"\r\n\r\ncategories = {"default", "vuln", "safe"}\r\n\r\nportrule = shortport.http\r\n\r\naction = function(host, port)\r\n  local resp, redirect_url, title\r\n\r\n  local basepath = stdnse.get_script_args(SCRIPT_NAME..".url")\r\n  local method = string.upper(stdnse.get_script_args(SCRIPT_NAME..".method") or "GET")\r\n\r\n  local vuln = {\r\n    title = "Microsoft Exchange - 0-day RCE",\r\n    state = vulns.STATE.NOT_VULN,\r\n    risk_factor = "High",\r\n    scores = {\r\n      CVSSv2 = "10.0 (HIGH) (AV:N/AC:L/AU:N/C:C/I:C/A:C)",\r\n    },\r\n    description = [[\r\nExchange 0-day vuln: CVE-2022-41082\r\n    ]],\r\n    IDS = {CVE = "CVE-2022-41082"},\r\n    references = {\r\n      \'https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/\',\r\n      \'https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/\',\r\n      \'https://microsoft.github.io/CSS-Exchange/Security/EOMTv2/\'\r\n    },\r\n    dates = { disclosure = { year = \'2022\', month = \'09\', day = \'29\' } }\r\n  }\r\n\r\n  local vuln_report = vulns.Report:new(SCRIPT_NAME, host, port)\r\n\r\n  if not basepath then\r\n    basepath = "/"\r\n  end\r\n\r\n  path = basepath .. \'autodiscover/autodiscover.json@Powershell.\'..rand.random_alpha(10)..\'.com/owa/\'\r\n\r\n  target = host.ip .. "-" .. port.number\r\n\r\n  stdnse.debug1("Final path: "..path)\r\n\r\n  local request_opts = {\r\n    header = {\r\n      Connection = "close"\r\n    },\r\n    bypass_cache = true,\r\n    no_cache = true\r\n  }\r\n\r\n  resp = http.get( host, port, path, request_opts )\r\n  -- check for a redirect\r\n  if resp.location then\r\n    redirect_url = resp.location[#resp.location]\r\n    if resp.status and tostring( resp.status ):match( "30%d" ) then\r\n      return {redirect_url = redirect_url}, ("Did not follow redirect to %s"):format( redirect_url )\r\n    end\r\n  end\r\n\r\n  local response = http.generic_request( host, port, method, path, { no_cache = true } )\r\n\r\n  if response.status and response.status == 401 then\r\n    -- X-OWA-Version\r\n    if response.header[\'x-owa-version\'] then\r\n      vuln.state = vulns.STATE.VULN\r\n    else\r\n      vuln.state = vulns.STATE.LIKELY_VULN\r\n    end\r\n  end\r\n\r\n  return vuln_report:make_output(vuln)\r\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"recursos-nmap",children:"Recursos NMAP"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.esecurityplanet.com/networks/nmap-vulnerability-scanning-made-easy/",children:"Nmap Vulnerability Scanning Made Easy (eSecurity Planet)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.hackingarticles.in/nmap-scans-using-hex-value-flags/",children:"Nmap Scans Using Hex Value Flags (Hacking Articles)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.hackingarticles.in/nmap-for-pentester-output-format-scan/",children:"Nmap for Pentester: Output Format Scan (Hacking Articles)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.hackingarticles.in/nmap-scan-with-timing-parameters/",children:"Nmap Scan with Timing Parameters (Hacking Articles)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.hackingarticles.in/understanding-nmap-packet-trace/",children:"Understanding Nmap Packet Trace (Hacking Articles)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/f0rk0ne/NSEarch-GUI/blob/main/README.es.md",children:"NSEarch-GUI (GitHub)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.codelivly.com/a-complete-guide-to-nmap-nmap-tutorial",children:"A Complete Guide to Nmap - Nmap Tutorial (Codelivly)"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},9087:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>o});var a=r(6363);const s={},t=a.createContext(s);function i(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);